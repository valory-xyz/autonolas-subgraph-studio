# Entity is only created if trader agent (with id 86) is registered in a service
# Allows tracking TraderAgent properly
type TraderService @entity (immutable: true) {
  id: ID! # serviceId
}

type TraderAgent @entity (immutable: false) {
  id: Bytes!
  serviceId: BigInt!
  firstParticipation: BigInt
  lastActive: BigInt
  totalBets: Int!
  totalTraded: BigInt! # trades amount for settled markets (when we have answer)
  totalPayout: BigInt! # all bets including for open markets
  totalFees: BigInt! # fees amount for settled markets (when we have answer)
  # bets: [Bet!]! @derivedFrom(field: "bettor")
  # dailyProfitStatistics: [DailyProfitStatistic!]! @derivedFrom(field: "traderAgent")
  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!
}

type ConditionPreparation @entity(immutable: true) {
  id: ID!
  conditionId: Bytes! # bytes32
  oracle: Bytes! # address
  questionId: Bytes! # bytes32
  outcomeSlotCount: BigInt! # uint256
  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!
}

type Question @entity(immutable: false) {
  id: Bytes!
  conditionId: Bytes! # bytes32
  metadata: MarketMetadata
  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!
}

type MarketMetadata @entity(immutable: true) {
  id: Bytes! # questionId
  title: String!
  outcomes: [String!]!
  description: String
}

type Global @entity (immutable: false) {
  id: ID!
  totalTraderAgents: Int!
  totalActiveTraderAgents: Int!
  totalBets: Int! # all bets including for open markets
  totalPayout: BigInt!
  totalTraded: BigInt! # trades amount for settled markets (when we have answer)
  totalFees: BigInt! # fees amount for settled markets (when we have answer)
}